<!DOCTYPE html>
<html>
<head>Random Forest Decision Trees Using Sparklyr<meta charset="utf-8"/></head>
  <nav>
    <h2> Navigation </h2>
      <ul>
        <li><a href="home.html"> Sparklyr </a></li>
        <li><a href="linearregression.html"> Linear Regression </a></li>
        <li><a href="logit.html"> Logistic Regression </a></li>
        <li><a href="randomforest.html"> Random Forest Decision Tree </a></li>
        <li><a href="kmeans.html"> K-Means Clustering </a></li>
      </ul>
    </nav>
<body>
<h1>Decision Trees (Random Forest) Sparklyr and R</h1>
    <p>Decision trees are one of the most powerful, and easy to use black box machine learning algorithms. The most common, and often used decision tree is the <em>Random Forest</em> algorithm. Random forest is a boot strapped regression tree that runs over a number of iterations. The forest in its name stems from the number of trees that are generated by this model. There are so many trees, that there is a forest. </p>

    <p> The process of creating a Random Forest decision tree in Sparklyr and R (the randomForest package) is quite simple and intuitive. I will walk you through the steps of creating a Random Forest Classifier using Sparklyr and the standard R package and do a brief comparison of their outputs. </p>

<h2> Getting the Data Ready </h2>
  <code># Loading local data wine <- read.csv("wine_classification.csv")
    <br>wine_tbl <- copy_to(sc, wine)</code>

<h2> Creating the models </h2>
  <pre>
# Create spark model
fit_spark <- wine_tbl %>% ml_random_forest(response = "quality",
                              features = c("pH", "alcohol", "density", "white"))

# Create base model
fit_base <- randomForest(quality ~ pH + alcohol + density + white, importance = T, data = wine_tbl)
 </pre>

<h2> Model Evaluation </h2>
  <h3> Spark model evaluation </h3>
    <pre>
  > summary(fit_spark)
                    Length Class      Mode
features             4     -none-     character
response             1     -none-     character
max.bins             1     -none-     numeric
max.depth            1     -none-     numeric
num.trees            1     -none-     numeric
feature.importances  4     -none-     numeric
trees               20     -none-     list
model.parameters     3     -none-     list
.model               2     spark_jobj environment </pre>

  <h3> Base model evaluation </h3>
      <pre>
> summary(fit_base)
                Length Class  Mode
call                6  -none- call
type                1  -none- character
predicted        5000  -none- numeric
mse               500  -none- numeric
rsq               500  -none- numeric
oob.times        5000  -none- numeric
importance          8  -none- numeric
importanceSD        4  -none- numeric
localImportance 20000  -none- numeric
proximity           0  -none- NULL
ntree               1  -none- numeric
mtry                1  -none- numeric
forest             11  -none- list
coefs               0  -none- NULL
y                5000  -none- numeric
test                0  -none- NULL
inbag               0  -none- NULL  </pre>

  </body>
</html>
